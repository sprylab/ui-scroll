{"version":3,"sources":["webpack:///webpack/bootstrap 68ae325e29ba217d0a27","webpack:///./src/modules/adapter.js","webpack:///./src/modules/buffer.js","webpack:///./src/modules/elementRoutines.js","webpack:///./src/modules/jqLiteExtras.js","webpack:///./src/modules/viewport.js","webpack:///./src/modules/padding.js","webpack:///./src/ui-scroll.js"],"names":["Adapter","viewport","buffer","adjustBuffer","reload","$attr","$parse","$scope","isLoading","disabled","viewportScope","getScope","startScope","$parent","publicContext","assignAdapter","adapter","generatePublicContext","adapterAttr","replace","adapterOnScope","assign","error","message","angular","extend","publicMethods","i","length","bind","publicProps","property","attr","Object","defineProperty","get","set","value","bof","eof","newItems","append","clipTop","clipBottom","prepend","arg1","arg2","isFunction","applyUpdatesFunc","applyUpdatesIndex","cb","slice","forEach","wrapper","applyUpdate","item","scope","element","index","Error","_index","first","getAbsMinIndex","getAbsMaxIndex","isArray","removeCacheItem","minIndex","incrementMinIndex","decrementMaxIndex","position","indexOf","reverse","some","newItem","op","_op","insert","rowTop","topHeight","topDone","bottomDone","itemTop","offset","top","itemHeight","outerHeight","topDataPos","topVisiblePos","bottomVisiblePos","isEOF","reference","console","log","removeByReference","ScrollBuffer","elementRoutines","bufferSize","create","Array","prototype","size","reset","startIndex","remove","next","maxIndex","minIndexUser","maxIndexUser","items","Math","max","min","operation","isTop","splice","push","unshift","isNumber","removeElement","removeElementAnimated","effectiveHeight","elements","Number","MAX_VALUE","bottom","NEGATIVE_INFINITY","offsetParent","hideClassToken","addCSSRule","sheet","selector","rules","insertRule","addRule","ElementRoutines","$injector","$q","$animate","has","isAngularVersionLessThen1_3","version","major","minor","document","styleSheets","addClass","removeClass","newElement","previousElement","after","$destroy","insertElement","deferred","defer","enter","resolve","promise","leave","then","JQLiteExtras","convertToPx","css","getStyle","isWindow","name","self","elem","nodeType","style","call","obj","location","alert","setInterval","scrollTo","direction","left","method","prop","preserve","isDefined","documentElement","window","getComputedStyle","parseFloat","currentStyle","result","rs","rsLeft","core_pnum","source","rnumnonpx","RegExp","test","runtimeStyle","pixelLeft","getMeasurements","measure","base","borderA","borderB","computedMarginA","computedMarginB","computedStyle","dirA","dirB","marginA","marginB","paddingA","paddingB","height","width","padding","border","margin","offsetWidth","offsetHeight","getWidthHeight","measurements","outer","outerfull","before","newElem","children","j","parent","ref","contents","outerHTML","option","outerWidth","docElem","win","box","doc","ownerDocument","arguments","undefined","getBoundingClientRect","defaultView","parentWindow","pageYOffset","scrollTop","clientTop","pageXOffset","scrollLeft","clientLeft","key","Viewport","viewportController","$rootScope","topPadding","bottomPadding","container","bufferPadding","createPaddingElements","template","applyContainerStyle","bottomDataPos","scrollHeight","e","sibling","insertElementAnimated","shouldLoadBottom","overage","overageHeight","emptySpaceHeight","cache","add","adjustPaddings","shouldLoadTop","visibleItemsHeight","reduce","summ","topPaddingHeight","topCount","bottomPaddingHeight","bottomCount","totalHeight","averageItemHeight","adjustTopPadding","adjustBottomPadding","topPaddingHeightAdd","bottomPaddingHeightAdd","onAfterMinIndexSet","topPaddingHeightOld","diff","onAfterPrepend","updates","prepended","paddingHeight","resetTopPadding","clear","resetBottomPadding","removeItem","itemAbove","getItemByReference","itemBelow","CacheProto","$index","timestamp_published","sort","a","b","argument","_isTop","Cache","instance","apply","setPrototypeOf","getOwnPropertyNames","methodName","generateElement","Node","ELEMENT_NODE","tagName","toLowerCase","table","find","Padding","module","service","run","jqLiteExtras","jQuery","registerFor","directive","restrict","controller","child","$timeout","$interval","require","transclude","priority","terminal","link","controllers","linker","match","uiScroll","parseNumericAttr","defaultValue","isNaN","BUFFER_MIN","BUFFER_DEFAULT","PADDING_MIN","PADDING_DEFAULT","MAX_VIEWPORT_DELAY","VIEWPORT_POLLING_INTERVAL","datasource","itemName","datasourceName","ridActual","pending","isDatasourceValid","isObject","onRenderHandlers","onRenderHandlersRunner","handler","preDefineIndexProperty","propName","getter","hasOwnProperty","defineIndexProperty","propUserName","descriptor","getOwnPropertyDescriptor","fetchNext","success","count","fetchPrevious","tryCount","timer","cancel","clone","$on","unbindEvents","unbind","wheelHandler","isInvalid","rid","$$destroyed","bindEvents","resizeAndScrollHandler","isElementVisible","visibilityWatcher","unregisterVisibilityWatcher","insertWrapperContent","insertAfter","createElement","$watch","hideElement","promises","transform","tdInitializer","uiScrollTdInitializer","linking","onLink","updateDOM","toBePrepended","toBeRemoved","inserted","concat","removed","animated","updatePaddings","all","enqueueFetch","loading","fetch","processUpdates","$$phase","$digest","showElement","w","calculateProperties","adjustBufferAfterFetch","shift","event","yMax","clientHeight","preventDefault"],"mappings":"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","file":"ui-scroll.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 68ae325e29ba217d0a27","/*jslint devel: true */\r\n\r\nclass Adapter {\r\n\r\n  constructor(viewport, buffer, adjustBuffer, reload, $attr, $parse, $scope) {\r\n    this.viewport = viewport;\r\n    this.buffer = buffer;\r\n    this.adjustBuffer = adjustBuffer;\r\n    this.reload = reload;\r\n\r\n    this.isLoading = false;\r\n    this.disabled = false;\r\n\r\n    const viewportScope = viewport.getScope();\r\n    this.startScope = viewportScope.$parent ? viewportScope : $scope;\r\n\r\n    this.publicContext = {};\r\n    this.assignAdapter($attr.adapter, $parse);\r\n    this.generatePublicContext($attr, $parse);\r\n  }\r\n\r\n  assignAdapter(adapterAttr, $parse) {\r\n    if (!adapterAttr || !(adapterAttr = adapterAttr.replace(/^\\s+|\\s+$/gm, ''))) {\r\n      return;\r\n    }\r\n    let adapterOnScope;\r\n\r\n    try {\r\n      $parse(adapterAttr).assign(this.startScope, {});\r\n      adapterOnScope = $parse(adapterAttr)(this.startScope);\r\n    }\r\n    catch (error) {\r\n      error.message = `Angular ui-scroll Adapter assignment exception.\\n` +\r\n        `Can't parse \"${adapterAttr}\" expression.\\n` +\r\n        error.message;\r\n      throw error;\r\n    }\r\n\r\n    angular.extend(adapterOnScope, this.publicContext);\r\n    this.publicContext = adapterOnScope;\r\n  }\r\n\r\n  generatePublicContext($attr, $parse) {\r\n    // these methods will be accessible out of ui-scroll via user defined adapter\r\n    const publicMethods = ['reload', 'applyUpdates', 'append', 'prepend', 'isBOF', 'isEOF', 'isEmpty', 'removeByReference'];\r\n    for (let i = publicMethods.length - 1; i >= 0; i--) {\r\n      this.publicContext[publicMethods[i]] = this[publicMethods[i]].bind(this);\r\n    }\r\n\r\n    // these read-only props will be accessible out of ui-scroll via user defined adapter\r\n    const publicProps = ['isLoading', 'topVisible', 'topVisibleElement', 'topVisibleScope', 'bottomVisible', 'bottomVisibleElement', 'bottomVisibleScope'];\r\n    for (let i = publicProps.length - 1; i >= 0; i--) {\r\n      let property, attr = $attr[publicProps[i]];\r\n      Object.defineProperty(this, publicProps[i], {\r\n        get: () => property,\r\n        set: (value) => {\r\n          property = value;\r\n          this.publicContext[publicProps[i]] = value;\r\n          if (attr) {\r\n            $parse(attr).assign(this.startScope, value);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    // non-read-only public property\r\n    Object.defineProperty(this.publicContext, 'disabled', {\r\n      get: () => this.disabled,\r\n      set: (value) => (!(this.disabled = value)) ? this.adjustBuffer() : null\r\n    });\r\n  }\r\n\r\n  loading(value) {\r\n    this['isLoading'] = value;\r\n  }\r\n\r\n  isBOF() {\r\n    return this.buffer.bof;\r\n  }\r\n\r\n  isEOF() {\r\n    return this.buffer.eof;\r\n  }\r\n\r\n  isEmpty() {\r\n    return !this.buffer.length;\r\n  }\r\n\r\n  append(newItems) {\r\n    this.buffer.append(newItems);\r\n    this.adjustBuffer();\r\n    this.viewport.clipTop();\r\n    this.viewport.clipBottom();\r\n  }\r\n\r\n  prepend(newItems) {\r\n    this.buffer.prepend(newItems);\r\n    this.adjustBuffer();\r\n    this.viewport.clipTop();\r\n    this.viewport.clipBottom();\r\n  }\r\n\r\n  applyUpdates(arg1, arg2) {\r\n    if (angular.isFunction(arg1)) {\r\n      this.applyUpdatesFunc(arg1);\r\n    } else {\r\n      this.applyUpdatesIndex(arg1, arg2);\r\n    }\r\n    this.adjustBuffer();\r\n  }\r\n\r\n  applyUpdatesFunc(cb) {\r\n    this.buffer.slice(0).forEach((wrapper) => {\r\n      // we need to do it on the buffer clone, because buffer content\r\n      // may change as we iterate through\r\n      this.applyUpdate(wrapper, cb(wrapper.item, wrapper.scope, wrapper.element));\r\n    });\r\n  }\r\n\r\n  applyUpdatesIndex(index, newItems) {\r\n    if (index % 1 !== 0) {\r\n      throw new Error('applyUpdates - ' + index + ' is not a valid index (should be an integer)');\r\n    }\r\n    const _index = index - this.buffer.first;\r\n\r\n    // apply updates only within buffer\r\n    if (_index >= 0 && _index < this.buffer.length) {\r\n      this.applyUpdate(this.buffer[_index], newItems);\r\n    }\r\n    // out-of-buffer case: deletion may affect Paddings\r\n    else if(index >= this.buffer.getAbsMinIndex() && index <= this.buffer.getAbsMaxIndex()) {\r\n      if(angular.isArray(newItems) && !newItems.length) {\r\n        this.viewport.removeCacheItem(index, index === this.buffer.minIndex);\r\n        if(index === this.buffer.getAbsMinIndex()) {\r\n          this.buffer.incrementMinIndex();\r\n        }\r\n        else {\r\n          this.buffer.decrementMaxIndex();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  applyUpdate(wrapper, newItems) {\r\n    if (!angular.isArray(newItems)) {\r\n      return;\r\n    }\r\n    let position = this.buffer.indexOf(wrapper);\r\n    if (!newItems.reverse().some(newItem => newItem === wrapper.item)) {\r\n      wrapper.op = 'remove';\r\n      if(position === 0 && !newItems.length) {\r\n        wrapper._op = 'isTop'; // to catch \"first\" edge case on remove\r\n      }\r\n    }\r\n    newItems.forEach((newItem) => {\r\n      if (newItem === wrapper.item) {\r\n        position--;\r\n      } else {\r\n        // 3 parameter (isTop) is to catch \"first\" edge case on insert\r\n        this.buffer.insert(position + 1, newItem, position === -1);\r\n      }\r\n    });\r\n  }\r\n\r\n  calculateProperties() {\r\n    let rowTop = null, topHeight = 0;\r\n    let topDone = false, bottomDone = false;\r\n    const length = this.buffer.length;\r\n\r\n    for (let i = 0; i < length; i++) {\r\n      const item = this.buffer[i];\r\n      const itemTop = item.element.offset().top;\r\n\r\n      if (rowTop !== itemTop) { // a new row condition\r\n        const itemHeight = item.element.outerHeight(true);\r\n        const top = this.viewport.topDataPos() + topHeight + itemHeight;\r\n\r\n        if (!topDone && top > this.viewport.topVisiblePos()) {\r\n          topDone = true;\r\n          this['topVisible'] = item.item;\r\n          this['topVisibleElement'] = item.element;\r\n          this['topVisibleScope'] = item.scope;\r\n        }\r\n        if (!bottomDone && (top >= this.viewport.bottomVisiblePos() || (i === length - 1 && this.isEOF()))) {\r\n          bottomDone = true;\r\n          this['bottomVisible'] = item.item;\r\n          this['bottomVisibleElement'] = item.element;\r\n          this['bottomVisibleScope'] = item.scope;\r\n        }\r\n        topHeight += itemHeight;\r\n      }\r\n      rowTop = itemTop;\r\n\r\n      if (topDone && bottomDone) {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  removeByReference(reference) {\r\n      console.log('remove by reference', reference);\r\n      return this.viewport.removeByReference(reference);\r\n  }\r\n\r\n}\r\n\r\nexport default Adapter;\n\n\n// WEBPACK FOOTER //\n// ./src/modules/adapter.js","export default function ScrollBuffer(elementRoutines, bufferSize) {\r\n  const buffer = Object.create(Array.prototype);\r\n\r\n  angular.extend(buffer, {\r\n    size: bufferSize,\r\n\r\n    reset(startIndex) {\r\n      buffer.remove(0, buffer.length);\r\n      buffer.eof = false;\r\n      buffer.bof = false;\r\n      buffer.first = startIndex;\r\n      buffer.next = startIndex;\r\n      buffer.minIndex = startIndex;\r\n      buffer.maxIndex = startIndex;\r\n      buffer.minIndexUser = null;\r\n      buffer.maxIndexUser = null;\r\n    },\r\n\r\n    append(items) {\r\n      items.forEach((item) => {\r\n        ++buffer.next;\r\n        buffer.insert('append', item);\r\n      });\r\n      buffer.maxIndex = buffer.eof ? buffer.next - 1 : Math.max(buffer.next - 1, buffer.maxIndex);\r\n    },\r\n\r\n    prepend(items) {\r\n      items.reverse().forEach((item) => {\r\n        --buffer.first;\r\n        buffer.insert('prepend', item);\r\n      });\r\n      buffer.minIndex = buffer.bof ? buffer.minIndex = buffer.first : Math.min(buffer.first, buffer.minIndex);\r\n    },\r\n\r\n    /**\r\n     * inserts wrapped element in the buffer\r\n     * the first argument is either operation keyword (see below) or a number for operation 'insert'\r\n     * for insert the number is the index for the buffer element the new one have to be inserted after\r\n     * operations: 'append', 'prepend', 'insert', 'remove', 'update', 'none'\r\n     */\r\n    insert(operation, item, isTop) {\r\n      const wrapper = {\r\n        item: item\r\n      };\r\n\r\n      if (operation % 1 === 0) {// it is an insert\r\n        wrapper.op = 'insert';\r\n        buffer.splice(operation, 0, wrapper);\r\n        if(isTop) {\r\n          buffer.first--;\r\n        }\r\n        else {\r\n          buffer.next++;\r\n        }\r\n      } else {\r\n        wrapper.op = operation;\r\n        switch (operation) {\r\n          case 'append':\r\n            buffer.push(wrapper);\r\n            break;\r\n          case 'prepend':\r\n            buffer.unshift(wrapper);\r\n            break;\r\n        }\r\n      }\r\n    },\r\n\r\n    // removes elements from buffer\r\n    remove(arg1, arg2) {\r\n      if (angular.isNumber(arg1)) {\r\n        // removes items from arg1 (including) through arg2 (excluding)\r\n        for (let i = arg1; i < arg2; i++) {\r\n          elementRoutines.removeElement(buffer[i]);\r\n        }\r\n\r\n        return buffer.splice(arg1, arg2 - arg1);\r\n      }\r\n      // removes single item(wrapper) from the buffer\r\n      buffer.splice(buffer.indexOf(arg1), 1);\r\n      if(arg1._op === 'isTop' && buffer.first === this.getAbsMinIndex()) {\r\n        this.incrementMinIndex();\r\n      }\r\n      else {\r\n        this.decrementMaxIndex();\r\n      }\r\n      if(arg1._op === 'isTop') {\r\n        buffer.first++;\r\n      }\r\n      else {\r\n        buffer.next--;\r\n      }\r\n      if(!buffer.length) {\r\n        buffer.first = 1;\r\n        buffer.next = 1;\r\n      }\r\n\r\n      return elementRoutines.removeElementAnimated(arg1);\r\n    },\r\n\r\n    incrementMinIndex() {\r\n      if(buffer.minIndexUser !== null) {\r\n        if(buffer.minIndex > buffer.minIndexUser) {\r\n          buffer.minIndexUser++;\r\n          return;\r\n        }\r\n        if(buffer.minIndex === buffer.minIndexUser) {\r\n          buffer.minIndexUser++;\r\n        }\r\n      }\r\n      buffer.minIndex++;\r\n    },\r\n\r\n    decrementMaxIndex() {\r\n      if(buffer.maxIndexUser !== null && buffer.maxIndex <= buffer.maxIndexUser) {\r\n        buffer.maxIndexUser--;\r\n      }\r\n      buffer.maxIndex--;\r\n    },\r\n\r\n    getAbsMinIndex() {\r\n      if(buffer.minIndexUser !== null) {\r\n        return Math.min(buffer.minIndexUser, buffer.minIndex);\r\n      }\r\n      return buffer.minIndex;\r\n    },\r\n\r\n    getAbsMaxIndex() {\r\n      if(buffer.maxIndexUser !== null) {\r\n        return Math.max(buffer.maxIndexUser, buffer.maxIndex);\r\n      }\r\n      return buffer.maxIndex;\r\n    },\r\n\r\n    effectiveHeight(elements) {\r\n      if (!elements.length) {\r\n        return 0;\r\n      }\r\n      let top = Number.MAX_VALUE;\r\n      let bottom = Number.NEGATIVE_INFINITY;\r\n      elements.forEach((wrapper) => {\r\n        if (wrapper.element[0].offsetParent) {\r\n          // element style is not display:none\r\n          top = Math.min(top, wrapper.element.offset().top);\r\n          bottom = Math.max(bottom, wrapper.element.offset().top + wrapper.element.outerHeight(true));\r\n        }\r\n      });\r\n      return Math.max(0, bottom - top);\r\n    }\r\n\r\n  });\r\n\r\n  return buffer;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/buffer.js","const hideClassToken = 'ng-ui-scroll-hide';\r\n\r\nfunction addCSSRule(sheet, selector, rules, index) {\r\n  if('insertRule' in sheet) {\r\n    sheet.insertRule(selector + '{' + rules + '}', index);\r\n  }\r\n  else if('addRule' in sheet) {\r\n    sheet.addRule(selector, rules, index);\r\n  }\r\n}\r\n\r\nexport default class ElementRoutines {\r\n\r\n  constructor($injector, $q) {\r\n    this.$animate = ($injector.has && $injector.has('$animate')) ? $injector.get('$animate') : null;\r\n    this.isAngularVersionLessThen1_3 = angular.version.major === 1 && angular.version.minor < 3;\r\n    this.$q = $q;\r\n    addCSSRule(document.styleSheets[0], '.' + hideClassToken, 'display: none');\r\n  }\r\n\r\n  hideElement(wrapper) {\r\n    wrapper.element.addClass(hideClassToken);\r\n  }\r\n\r\n  showElement(wrapper) {\r\n    wrapper.element.removeClass(hideClassToken);\r\n  }\r\n\r\n  insertElement(newElement, previousElement) {\r\n    previousElement.after(newElement);\r\n    return [];\r\n  }\r\n\r\n  removeElement(wrapper) {\r\n    wrapper.element.remove();\r\n    wrapper.scope.$destroy();\r\n    return [];\r\n  }\r\n\r\n  insertElementAnimated(newElement, previousElement) {\r\n    if (!this.$animate) {\r\n      return this.insertElement(newElement, previousElement);\r\n    }\r\n\r\n    if (this.isAngularVersionLessThen1_3) {\r\n      const deferred = this.$q.defer();\r\n      // no need for parent - previous element is never null\r\n      this.$animate.enter(newElement, null, previousElement, () => deferred.resolve());\r\n\r\n      return [deferred.promise];\r\n    }\r\n\r\n    // no need for parent - previous element is never null\r\n    return [this.$animate.enter(newElement, null, previousElement)];\r\n  }\r\n\r\n  removeElementAnimated(wrapper) {\r\n    if (!this.$animate) {\r\n      return this.removeElement(wrapper);\r\n    }\r\n\r\n    if (this.isAngularVersionLessThen1_3) {\r\n      const deferred = this.$q.defer();\r\n      this.$animate.leave(wrapper.element, () => {\r\n        wrapper.scope.$destroy();\r\n        return deferred.resolve();\r\n      });\r\n\r\n      return [deferred.promise];\r\n    }\r\n\r\n    return [(this.$animate.leave(wrapper.element)).then(() => wrapper.scope.$destroy())];\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/elementRoutines.js","/*!\r\n globals: angular, window\r\n List of used element methods available in JQuery but not in JQuery Lite\r\n element.before(elem)\r\n element.height()\r\n element.outerHeight(true)\r\n element.height(value) = only for Top/Bottom padding elements\r\n element.scrollTop()\r\n element.scrollTop(value)\r\n */\r\n\r\nexport default class JQLiteExtras {\r\n\r\n  registerFor(element) {\r\n    let convertToPx, css, getStyle, isWindow;\r\n    // angular implementation blows up if elem is the window\r\n    css = angular.element.prototype.css;\r\n\r\n    element.prototype.css = function (name, value) {\r\n      let self = this;\r\n      let elem = self[0];\r\n      if (!(!elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style)) {\r\n        return css.call(self, name, value);\r\n      }\r\n    };\r\n\r\n    // as defined in angularjs v1.0.5\r\n    isWindow = (obj) => obj && obj.document && obj.location && obj.alert && obj.setInterval;\r\n\r\n    function scrollTo(self, direction, value) {\r\n      let elem = self[0];\r\n      let [method, prop, preserve] = {\r\n        top: [\r\n          'scrollTop',\r\n          'pageYOffset',\r\n          'scrollLeft'\r\n        ],\r\n        left: [\r\n          'scrollLeft',\r\n          'pageXOffset',\r\n          'scrollTop'\r\n        ]\r\n      }[direction];\r\n\r\n      if (isWindow(elem)) {\r\n        if (angular.isDefined(value)) {\r\n          return elem.scrollTo(self[preserve].call(self), value);\r\n        }\r\n        return (prop in elem) ? elem[prop] : elem.document.documentElement[method];\r\n      } else {\r\n        if (angular.isDefined(value)) {\r\n          elem[method] = value;\r\n        }\r\n        return elem[method];\r\n      }\r\n    }\r\n\r\n    if (window.getComputedStyle) {\r\n      getStyle = (elem) => window.getComputedStyle(elem, null);\r\n      convertToPx = (elem, value) => parseFloat(value);\r\n    } else {\r\n      getStyle = (elem) => elem.currentStyle;\r\n      convertToPx = (elem, value) => {\r\n        let left, result, rs, rsLeft, style;\r\n        let core_pnum = /[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source;\r\n        let rnumnonpx = new RegExp('^(' + core_pnum + ')(?!px)[a-z%]+$', 'i');\r\n\r\n        if (!rnumnonpx.test(value)) {\r\n          return parseFloat(value);\r\n        }\r\n\r\n        // ported from JQuery\r\n        style = elem.style;\r\n        left = style.left;\r\n        rs = elem.runtimeStyle;\r\n        rsLeft = rs && rs.left;\r\n        if (rs) {\r\n          rs.left = style.left;\r\n        }\r\n        // put in the new values to get a computed style out\r\n        style.left = value;\r\n        result = style.pixelLeft;\r\n        style.left = left;\r\n        if (rsLeft) {\r\n          rs.left = rsLeft;\r\n        }\r\n        return result;\r\n      };\r\n    }\r\n\r\n    function getMeasurements(elem, measure) {\r\n      let base, borderA, borderB, computedMarginA, computedMarginB, computedStyle, dirA, dirB, marginA, marginB, paddingA, paddingB;\r\n\r\n      if (isWindow(elem)) {\r\n        base = document.documentElement[{height: 'clientHeight', width: 'clientWidth'}[measure]];\r\n\r\n        return {\r\n          base: base,\r\n          padding: 0,\r\n          border: 0,\r\n          margin: 0\r\n        };\r\n      }\r\n\r\n      // Start with offset property\r\n      [\r\n        base,\r\n        dirA,\r\n        dirB\r\n      ] = {\r\n        width: [\r\n          elem.offsetWidth,\r\n          'Left',\r\n          'Right'\r\n        ],\r\n        height: [\r\n          elem.offsetHeight,\r\n          'Top',\r\n          'Bottom'\r\n        ]\r\n      }[measure];\r\n\r\n      computedStyle = getStyle(elem);\r\n      paddingA = convertToPx(elem, computedStyle['padding' + dirA]) || 0;\r\n      paddingB = convertToPx(elem, computedStyle['padding' + dirB]) || 0;\r\n      borderA = convertToPx(elem, computedStyle['border' + dirA + 'Width']) || 0;\r\n      borderB = convertToPx(elem, computedStyle['border' + dirB + 'Width']) || 0;\r\n      computedMarginA = computedStyle['margin' + dirA];\r\n      computedMarginB = computedStyle['margin' + dirB];\r\n\r\n      // I do not care for width for now, so this hack is irrelevant\r\n      // if ( !supportsPercentMargin )\r\n      // computedMarginA = hackPercentMargin( elem, computedStyle, computedMarginA )\r\n      // computedMarginB = hackPercentMargin( elem, computedStyle, computedMarginB )\r\n      marginA = convertToPx(elem, computedMarginA) || 0;\r\n      marginB = convertToPx(elem, computedMarginB) || 0;\r\n\r\n      return {\r\n        base: base,\r\n        padding: paddingA + paddingB,\r\n        border: borderA + borderB,\r\n        margin: marginA + marginB\r\n      };\r\n    }\r\n\r\n    function getWidthHeight(elem, direction, measure) {\r\n      let computedStyle, result;\r\n\r\n      let measurements = getMeasurements(elem, direction);\r\n\r\n      if (measurements.base > 0) {\r\n        return {\r\n          base: measurements.base - measurements.padding - measurements.border,\r\n          outer: measurements.base,\r\n          outerfull: measurements.base + measurements.margin\r\n        }[measure];\r\n      }\r\n\r\n      // Fall back to computed then uncomputed css if necessary\r\n      computedStyle = getStyle(elem);\r\n      result = computedStyle[direction];\r\n\r\n      if (result < 0 || result === null) {\r\n        result = elem.style[direction] || 0;\r\n      }\r\n\r\n      // Normalize \"\", auto, and prepare for extra\r\n      result = parseFloat(result) || 0;\r\n\r\n      return {\r\n        base: result - measurements.padding - measurements.border,\r\n        outer: result,\r\n        outerfull: result + measurements.padding + measurements.border + measurements.margin\r\n      }[measure];\r\n    }\r\n\r\n    // define missing methods\r\n    return angular.forEach({\r\n      before(newElem) {\r\n        var children, elem, i, j, parent, ref, self;\r\n        self = this;\r\n        elem = self[0];\r\n        parent = self.parent();\r\n        children = parent.contents();\r\n        if (children[0] === elem) {\r\n          return parent.prepend(newElem);\r\n        } else {\r\n          for (i = j = 1, ref = children.length - 1; 1 <= ref ? j <= ref : j >= ref; i = 1 <= ref ? ++j : --j) {\r\n            if (children[i] === elem) {\r\n              angular.element(children[i - 1]).after(newElem);\r\n              return;\r\n            }\r\n          }\r\n          throw new Error('invalid DOM structure ' + elem.outerHTML);\r\n        }\r\n      },\r\n      height (value){\r\n        var self;\r\n        self = this;\r\n        if (angular.isDefined(value)) {\r\n          if (angular.isNumber(value)) {\r\n            value = value + 'px';\r\n          }\r\n          return css.call(self, 'height', value);\r\n        } else {\r\n          return getWidthHeight(this[0], 'height', 'base');\r\n        }\r\n      },\r\n      outerHeight(option) {\r\n        return getWidthHeight(this[0], 'height', option ? 'outerfull' : 'outer');\r\n      },\r\n      outerWidth(option) {\r\n        return getWidthHeight(this[0], 'width', option ? 'outerfull' : 'outer');\r\n      },\r\n\r\n      /*\r\n       The offset setter method is not implemented\r\n       */\r\n      offset(value) {\r\n        let docElem, win;\r\n        let self = this;\r\n        let box = {\r\n          top: 0,\r\n          left: 0\r\n        };\r\n        let elem = self[0];\r\n        let doc = elem && elem.ownerDocument;\r\n\r\n        if (arguments.length) {\r\n          if (value === undefined) {\r\n            return self;\r\n          }\r\n          // TODO: implement setter\r\n          throw new Error('offset setter method is not implemented');\r\n        }\r\n\r\n        if (!doc) {\r\n          return;\r\n        }\r\n\r\n        docElem = doc.documentElement;\r\n\r\n        // TODO: Make sure it's not a disconnected DOM node\r\n\r\n        if (elem.getBoundingClientRect != null) {\r\n          box = elem.getBoundingClientRect();\r\n        }\r\n\r\n        win = doc.defaultView || doc.parentWindow;\r\n\r\n        return {\r\n          top: box.top + (win.pageYOffset || docElem.scrollTop) - (docElem.clientTop || 0),\r\n          left: box.left + (win.pageXOffset || docElem.scrollLeft) - (docElem.clientLeft || 0)\r\n        };\r\n      },\r\n      scrollTop(value) {\r\n        return scrollTo(this, 'top', value);\r\n      },\r\n      scrollLeft(value) {\r\n        return scrollTo(this, 'left', value);\r\n      }\r\n    }, (value, key) => {\r\n      if (!element.prototype[key]) {\r\n        return element.prototype[key] = value;\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/jqLiteExtras.js","/*jslint devel: true */\r\n\r\nimport Padding from './padding';\r\n\r\nexport default function Viewport(elementRoutines, buffer, element, viewportController, $rootScope, padding) {\r\n  let topPadding = null;\r\n  let bottomPadding = null;\r\n  const viewport = viewportController && viewportController.viewport ? viewportController.viewport : angular.element(window);\r\n  const container = viewportController && viewportController.container ? viewportController.container : undefined;\r\n  const scope = viewportController && viewportController.scope ? viewportController.scope : $rootScope;\r\n\r\n  viewport.css({\r\n    'overflow-anchor': 'none',\r\n    'overflow-y': 'auto',\r\n    'display': 'block'\r\n  });\r\n\r\n  function bufferPadding() {\r\n    return viewport.outerHeight() * padding; // some extra space to initiate preload\r\n  }\r\n\r\n  angular.extend(viewport, {\r\n    getScope() {\r\n      return scope;\r\n    },\r\n\r\n    createPaddingElements(template) {\r\n      topPadding = new Padding(template);\r\n      bottomPadding = new Padding(template);\r\n      element.before(topPadding.element);\r\n      element.after(bottomPadding.element);\r\n      topPadding.height(0);\r\n      bottomPadding.height(0);\r\n    },\r\n\r\n    applyContainerStyle() {\r\n      if (!container) {\r\n        return true;\r\n      }\r\n      if(container !== viewport) {\r\n        viewport.css('height', window.getComputedStyle(container[0]).height);\r\n      }\r\n      return viewport.height() > 0;\r\n    },\r\n\r\n    bottomDataPos() {\r\n      let scrollHeight = viewport[0].scrollHeight;\r\n      scrollHeight = scrollHeight != null ? scrollHeight : viewport[0].document.documentElement.scrollHeight;\r\n      return scrollHeight - bottomPadding.height();\r\n    },\r\n\r\n    topDataPos() {\r\n      return topPadding.height();\r\n    },\r\n\r\n    bottomVisiblePos() {\r\n      return viewport.scrollTop() + viewport.outerHeight();\r\n    },\r\n\r\n    topVisiblePos() {\r\n      return viewport.scrollTop();\r\n    },\r\n\r\n    insertElement(e, sibling) {\r\n      return elementRoutines.insertElement(e, sibling || topPadding.element);\r\n    },\r\n\r\n    insertElementAnimated(e, sibling) {\r\n      return elementRoutines.insertElementAnimated(e, sibling || topPadding.element);\r\n    },\r\n\r\n    shouldLoadBottom() {\r\n      return !buffer.eof && viewport.bottomDataPos() < viewport.bottomVisiblePos() + bufferPadding();\r\n    },\r\n\r\n    clipBottom() {\r\n      // clip the invisible items off the bottom\r\n      let overage = 0;\r\n      let overageHeight = 0;\r\n      let itemHeight = 0;\r\n      let emptySpaceHeight = viewport.bottomDataPos() - viewport.bottomVisiblePos() - bufferPadding();\r\n\r\n      for (let i = buffer.length - 1; i >= 0; i--) {\r\n        itemHeight = buffer[i].element.outerHeight(true);\r\n        if (overageHeight + itemHeight > emptySpaceHeight) {\r\n          break;\r\n        }\r\n        bottomPadding.cache.add(buffer[i]);\r\n        overageHeight += itemHeight;\r\n        overage++;\r\n      }\r\n\r\n      if (overage > 0) {\r\n        buffer.eof = false;\r\n        buffer.remove(buffer.length - overage, buffer.length);\r\n        buffer.next -= overage;\r\n        viewport.adjustPaddings();\r\n      }\r\n    },\r\n\r\n    shouldLoadTop() {\r\n      return !buffer.bof && (viewport.topDataPos() > viewport.topVisiblePos() - bufferPadding());\r\n    },\r\n\r\n    clipTop() {\r\n      // clip the invisible items off the top\r\n      let overage = 0;\r\n      let overageHeight = 0;\r\n      let itemHeight = 0;\r\n      let emptySpaceHeight = viewport.topVisiblePos() - viewport.topDataPos() - bufferPadding();\r\n\r\n      for (let i = 0; i < buffer.length; i++) {\r\n        itemHeight = buffer[i].element.outerHeight(true);\r\n        if (overageHeight + itemHeight > emptySpaceHeight) {\r\n          break;\r\n        }\r\n        topPadding.cache.add(buffer[i]);\r\n        overageHeight += itemHeight;\r\n        overage++;\r\n      }\r\n\r\n      if (overage > 0) {\r\n        // we need to adjust top padding element before items are removed from top\r\n        // to avoid strange behaviour of scroll bar during remove top items when we are at the very bottom\r\n        topPadding.height(topPadding.height() + overageHeight);\r\n        buffer.bof = false;\r\n        buffer.remove(0, overage);\r\n        buffer.first += overage;\r\n      }\r\n    },\r\n\r\n    adjustPaddings() {\r\n      if (!buffer.length) {\r\n        return;\r\n      }\r\n\r\n      // precise heights calculation based on items that are in buffer or that were in buffer once\r\n      const visibleItemsHeight = buffer.reduce((summ, item) => summ + item.element.outerHeight(true), 0);\r\n\r\n      let topPaddingHeight = 0, topCount = 0;\r\n      topPadding.cache.forEach(item => {\r\n        if(item.index < buffer.first) {\r\n          topPaddingHeight += item.height;\r\n          topCount++;\r\n        }\r\n      });\r\n\r\n      let bottomPaddingHeight = 0, bottomCount = 0;\r\n      bottomPadding.cache.forEach(item => {\r\n        if(item.index >= buffer.next) {\r\n          bottomPaddingHeight += item.height;\r\n          bottomCount++;\r\n        }\r\n      });\r\n\r\n      const totalHeight = visibleItemsHeight + topPaddingHeight + bottomPaddingHeight;\r\n      const averageItemHeight = totalHeight / (topCount + bottomCount + buffer.length);\r\n\r\n      // average heights calculation, items that have never been reached\r\n      let adjustTopPadding = buffer.minIndexUser !== null && buffer.minIndex > buffer.minIndexUser;\r\n      let adjustBottomPadding = buffer.maxIndexUser !== null && buffer.maxIndex < buffer.maxIndexUser;\r\n      let topPaddingHeightAdd = adjustTopPadding ? (buffer.minIndex - buffer.minIndexUser) * averageItemHeight : 0;\r\n      let bottomPaddingHeightAdd = adjustBottomPadding ? (buffer.maxIndexUser - buffer.maxIndex) * averageItemHeight : 0;\r\n\r\n      // paddings combine adjustment\r\n      topPadding.height(topPaddingHeight + topPaddingHeightAdd);\r\n      bottomPadding.height(bottomPaddingHeight + bottomPaddingHeightAdd);\r\n    },\r\n\r\n    onAfterMinIndexSet(topPaddingHeightOld) {\r\n      // additional scrollTop adjustment in case of datasource.minIndex external set\r\n      if (buffer.minIndexUser !== null && buffer.minIndex > buffer.minIndexUser) {\r\n        let diff = topPadding.height() - topPaddingHeightOld;\r\n        viewport.scrollTop(viewport.scrollTop() + diff);\r\n        diff -= viewport.scrollTop();\r\n        if(diff > 0) {\r\n          bottomPadding.height(bottomPadding.height() + diff);\r\n          viewport.scrollTop(viewport.scrollTop() + diff);\r\n        }\r\n      }\r\n    },\r\n\r\n    onAfterPrepend(updates) {\r\n      if (!updates.prepended.length)\r\n        return;\r\n      const height = buffer.effectiveHeight(updates.prepended);\r\n      const paddingHeight = topPadding.height() - height;\r\n      if (paddingHeight >= 0) {\r\n        topPadding.height(paddingHeight);\r\n      }\r\n      else {\r\n        topPadding.height(0);\r\n        viewport.scrollTop(viewport.scrollTop() - paddingHeight);\r\n      }\r\n    },\r\n\r\n    resetTopPadding() {\r\n      topPadding.height(0);\r\n      topPadding.cache.clear();\r\n    },\r\n\r\n    resetBottomPadding() {\r\n      bottomPadding.height(0);\r\n      bottomPadding.cache.clear();\r\n    },\r\n\r\n    removeCacheItem(item, isTop) {\r\n      topPadding.cache.remove(item, isTop);\r\n      bottomPadding.cache.remove(item, isTop);\r\n    },\r\n\r\n    removeItem(item) {\r\n      this.removeCacheItem(item);\r\n      return buffer.remove(item);\r\n    },\r\n      removeByReference(reference) {\r\n\r\n          console.log('reference', reference);\r\n\r\n          var itemAbove = topPadding.cache.getItemByReference(reference);\r\n          var itemBelow = bottomPadding.cache.getItemByReference(reference);\r\n\r\n          if(!itemAbove && !itemBelow){\r\n              return;\r\n          }\r\n\r\n          try {\r\n              console.log('remove item from cache', itemAbove || itemBelow);\r\n              this.removeCacheItem(itemAbove.item || itemBelow.item);\r\n\r\n              if (itemAbove) {\r\n                  console.log('item is from top padding');\r\n                  // we try to delete a hidden item above\r\n                  buffer.next--;\r\n                  buffer.first--;\r\n\r\n                  window.scrollTo(0, window.pageYOffset - itemAbove.height);\r\n\r\n                  console.log('decremented buffer indices to buffer.next, buffer.first', buffer.next, buffer.first);\r\n              }\r\n\r\n          } catch (e) {}\r\n          return true;\r\n      },\r\n  });\r\n\r\n  return viewport;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/viewport.js","// Can't just extend the Array, due to Babel does not support built-in classes extending\r\n// This solution was taken from https://stackoverflow.com/questions/46897414/es6-class-extends-array-workaround-for-es5-babel-transpile\r\n\r\n/*jslint devel: true */\r\n\r\nclass CacheProto {\r\n  add(item) {\r\n    for (let i = this.length - 1; i >= 0; i--) {\r\n      if (this[i].index === item.scope.$index) {\r\n        this[i].height = item.element.outerHeight();\r\n        return;\r\n      }\r\n    }\r\n    this.push({\r\n      index: item.scope.$index,\r\n      height: item.element.outerHeight(),\r\n      reference: item.item.timestamp_published, // FIXME generic \"reference\" attribute should be provided\r\n      item: item\r\n    });\r\n    this.sort((a, b) => ((a.index < b.index) ? -1 : ((a.index > b.index) ? 1 : 0)));\r\n  }\r\n\r\n  getItemByReference(reference) {\r\n    console.log('get item by reference', reference);\r\n      for (var i = this.length - 1; i >= 0; i--) {\r\n          if (this[i].reference === reference) {\r\n              console.log('found index match', this[i].index);\r\n              return this[i];\r\n          }\r\n      }\r\n  }\r\n\r\n  remove(argument, _isTop) {\r\n    const index = argument % 1 === 0 ? argument : argument.scope.$index;\r\n    const isTop = argument % 1 === 0 ? _isTop : argument._op === 'isTop';\r\n    for (let i = this.length - 1; i >= 0; i--) {\r\n      if (this[i].index === index) {\r\n        this.splice(i, 1);\r\n        break;\r\n      }\r\n    }\r\n    if(!isTop) {\r\n      for (let i = this.length - 1; i >= 0; i--) {\r\n        if (this[i].index > index) {\r\n          this[i].index--;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  clear() {\r\n    this.length = 0;\r\n  }\r\n}\r\n\r\nfunction Cache() {\r\n  const instance = [];\r\n  instance.push.apply(instance, arguments);\r\n  Object.setPrototypeOf(instance, Cache.prototype);\r\n  return instance;\r\n}\r\nCache.prototype = Object.create(Array.prototype);\r\nObject.getOwnPropertyNames(CacheProto.prototype).forEach(methodName =>\r\n  Cache.prototype[methodName] = CacheProto.prototype[methodName]\r\n);\r\n\r\nfunction generateElement(template) {\r\n  if(template.nodeType !== Node.ELEMENT_NODE) {\r\n    throw new Error('ui-scroll directive requires an Element node for templating the view');\r\n  }\r\n  let element;\r\n  switch (template.tagName.toLowerCase()) {\r\n    case 'dl':\r\n      throw new Error(`ui-scroll directive does not support <${template.tagName}> as a repeating tag: ${template.outerHTML}`);\r\n    case 'tr':\r\n      let table = angular.element('<table><tr><td><div></div></td></tr></table>');\r\n      element = table.find('tr');\r\n      break;\r\n    case 'li':\r\n      element = angular.element('<li></li>');\r\n      break;\r\n    default:\r\n      element = angular.element('<div></div>');\r\n  }\r\n  return element;\r\n}\r\n\r\nclass Padding {\r\n  constructor(template) {\r\n    this.element = generateElement(template);\r\n    this.cache = new Cache();\r\n  }\r\n\r\n  height() {\r\n    return this.element.height.apply(this.element, arguments);\r\n  }\r\n}\r\n\r\nexport default Padding;\n\n\n// WEBPACK FOOTER //\n// ./src/modules/padding.js","import JQLiteExtras from './modules/jqLiteExtras';\nimport ElementRoutines from './modules/elementRoutines.js';\nimport ScrollBuffer from './modules/buffer.js';\nimport Viewport from './modules/viewport.js';\nimport Adapter from './modules/adapter.js';\n\nangular.module('ui.scroll', [])\n\n  .service('jqLiteExtras', () => new JQLiteExtras())\n  .run(['jqLiteExtras', (jqLiteExtras) =>\n    !window.jQuery ? jqLiteExtras.registerFor(angular.element) : null\n  ])\n\n  .directive('uiScrollViewport', function () {\n    return {\n      restrict: 'A',\n      controller: [\n        '$scope',\n        '$element',\n        function (scope, element) {\n          this.container = element;\n          this.viewport = element;\n          this.scope = scope;\n\n          angular.forEach(element.children(), (child => {\n            if (child.tagName.toLowerCase() === 'tbody') {\n              this.viewport = angular.element(child);\n            }\n          }));\n\n          return this;\n        }\n      ]\n    };\n  })\n\n  .directive('uiScroll', [\n    '$log',\n    '$injector',\n    '$rootScope',\n    '$timeout',\n    '$interval',\n    '$q',\n    '$parse',\n    function (console, $injector, $rootScope, $timeout, $interval, $q, $parse) {\n\n      return {\n        require: ['?^uiScrollViewport'],\n        restrict: 'A',\n        transclude: 'element',\n        priority: 1000,\n        terminal: true,\n        link: link\n      };\n\n      function link($scope, element, $attr, controllers, linker) {\n        const match = $attr.uiScroll.match(/^\\s*(\\w+)\\s+in\\s+([(\\w|\\$)\\.]+)\\s*$/);\n        if (!match) {\n          throw new Error('Expected uiScroll in form of \\'_item_ in _datasource_\\' but got \\'' + $attr.uiScroll + '\\'');\n        }\n\n        function parseNumericAttr(value, defaultValue) {\n          const result = $parse(value)($scope);\n          return isNaN(result) ? defaultValue : result;\n        }\n\n        const BUFFER_MIN = 3;\n        const BUFFER_DEFAULT = 10;\n        const PADDING_MIN = 0.3;\n        const PADDING_DEFAULT = 0.5;\n        const MAX_VIEWPORT_DELAY = 500;\n        const VIEWPORT_POLLING_INTERVAL = 50;\n\n        let datasource = null;\n        const itemName = match[1];\n        const datasourceName = match[2];\n        const viewportController = controllers[0];\n        const bufferSize = Math.max(BUFFER_MIN, parseNumericAttr($attr.bufferSize, BUFFER_DEFAULT));\n        const padding = Math.max(PADDING_MIN, parseNumericAttr($attr.padding, PADDING_DEFAULT));\n        let startIndex = parseNumericAttr($attr.startIndex, 1);\n        let ridActual = 0;// current data revision id\n        let pending = [];\n\n        const elementRoutines = new ElementRoutines($injector, $q);\n        const buffer = new ScrollBuffer(elementRoutines, bufferSize);\n        const viewport = new Viewport(elementRoutines, buffer, element, viewportController, $rootScope, padding);\n        const adapter = new Adapter(viewport, buffer, adjustBuffer, reload, $attr, $parse, $scope);\n\n        if (viewportController) {\n          viewportController.adapter = adapter;\n        }\n\n        const isDatasourceValid = () => angular.isObject(datasource) && angular.isFunction(datasource.get);\n        datasource = $parse(datasourceName)($scope); // try to get datasource on scope\n        if (!isDatasourceValid()) {\n          datasource = $injector.get(datasourceName); // try to inject datasource as service\n          if (!isDatasourceValid()) {\n            throw new Error(datasourceName + ' is not a valid datasource');\n          }\n        }\n\n        let onRenderHandlers = [];\n        function onRenderHandlersRunner() {\n          if(onRenderHandlers.length) {\n            angular.forEach(onRenderHandlers, (handler) => handler());\n            onRenderHandlers = [];\n          }\n        }\n        function preDefineIndexProperty(datasource, propName) {\n          let getter;\n          // need to postpone min/maxIndexUser processing if the view is empty\n          if(datasource.hasOwnProperty(propName) && !buffer.length) {\n            getter = datasource[propName];\n            delete datasource[propName];\n            onRenderHandlers.push(() => datasource[propName] = getter);\n          }\n        }\n\n        function defineIndexProperty(datasource, propName, propUserName) {\n          const descriptor = Object.getOwnPropertyDescriptor(datasource, propName);\n          if (descriptor && (descriptor.set || descriptor.get)) {\n            return;\n          }\n          let getter;\n          preDefineIndexProperty(datasource, propName);\n          Object.defineProperty(datasource, propName, {\n            set: (value) => {\n              getter = value;\n              buffer[propUserName] = value;\n              const topPaddingHeightOld = viewport.topDataPos();\n              viewport.adjustPaddings();\n              if (propName === 'minIndex') {\n                viewport.onAfterMinIndexSet(topPaddingHeightOld);\n              }\n            },\n            get: () => getter\n          });\n        }\n\n        defineIndexProperty(datasource, 'minIndex', 'minIndexUser');\n        defineIndexProperty(datasource, 'maxIndex', 'maxIndexUser');\n\n        const fetchNext = (datasource.get.length !== 2) ?\n          (success) => datasource.get(buffer.next, bufferSize, success) :\n          (success) => {\n            datasource.get({\n              index: buffer.next,\n              append: buffer.length ? buffer[buffer.length - 1].item : void 0,\n              count: bufferSize\n            }, success);\n          };\n\n        const fetchPrevious = (datasource.get.length !== 2) ?\n          (success) => datasource.get(buffer.first - bufferSize, bufferSize, success) :\n          (success) => {\n            datasource.get({\n              index: buffer.first - bufferSize,\n              prepend: buffer.length ? buffer[0].item : void 0,\n              count: bufferSize\n            }, success);\n          };\n\n        const run = () => {\n          let tryCount = 0;\n          if(!viewport.applyContainerStyle()) {\n            const timer = $interval(() => {\n              tryCount++;\n              if(viewport.applyContainerStyle()) {\n                $interval.cancel(timer);\n                reload();\n              }\n              if(tryCount * VIEWPORT_POLLING_INTERVAL >= MAX_VIEWPORT_DELAY) {\n                $interval.cancel(timer);\n                throw Error(`ui-scroll directive requires a viewport with non-zero height in ${MAX_VIEWPORT_DELAY}ms`);\n              }\n            }, VIEWPORT_POLLING_INTERVAL);\n          }\n          else {\n            reload();\n          }\n        };\n\n        /**\n         * Build padding elements\n         *\n         * Calling linker is the only way I found to get access to the tag name of the template\n         * to prevent the directive scope from pollution a new scope is created and destroyed\n         * right after the builder creation is completed\n         */\n        linker((clone, scope) => {\n          viewport.createPaddingElements(clone[0]);\n          // we do not include the clone in the DOM. It means that the nested directives will not\n          // be able to reach the parent directives, but in this case it is intentional because we\n          // created the clone to access the template tag name\n          scope.$destroy();\n          clone.remove();\n        });\n\n        $scope.$on('$destroy', () => {\n          unbindEvents();\n          viewport.unbind('mousewheel', wheelHandler);\n        });\n\n        viewport.bind('mousewheel', wheelHandler);\n\n        run();\n\n        /* Private function definitions */\n\n        function isInvalid(rid) {\n          return (rid && rid !== ridActual) || $scope.$$destroyed;\n        }\n\n        function bindEvents() {\n          viewport.bind('resize', resizeAndScrollHandler);\n          viewport.bind('scroll', resizeAndScrollHandler);\n        }\n\n        function unbindEvents() {\n          viewport.unbind('resize', resizeAndScrollHandler);\n          viewport.unbind('scroll', resizeAndScrollHandler);\n        }\n\n        function reload() {\n          viewport.resetTopPadding();\n          viewport.resetBottomPadding();\n          if (arguments.length) {\n            startIndex = arguments[0];\n          }\n          buffer.reset(startIndex);\n          adjustBuffer();\n        }\n\n        function isElementVisible(wrapper) {\n          return wrapper.element.height() && wrapper.element[0].offsetParent;\n        }\n\n        function visibilityWatcher(wrapper) {\n          if (isElementVisible(wrapper)) {\n            buffer.forEach((item) => {\n              if (angular.isFunction(item.unregisterVisibilityWatcher)) {\n                item.unregisterVisibilityWatcher();\n                delete item.unregisterVisibilityWatcher;\n              }\n            });\n            if (!pending.length) {\n              $timeout(() => adjustBuffer());\n            }\n          }\n        }\n\n        function insertWrapperContent(wrapper, insertAfter) {\n          createElement(wrapper, insertAfter, viewport.insertElement);\n          if (!isElementVisible(wrapper)) {\n            wrapper.unregisterVisibilityWatcher = wrapper.scope.$watch(() => visibilityWatcher(wrapper));\n          }\n          elementRoutines.hideElement(wrapper); // hide inserted elements before data binding\n        }\n\n        function createElement(wrapper, insertAfter, insertElement) {\n          let promises = null;\n          const sibling = (insertAfter > 0) ? buffer[insertAfter - 1].element : undefined;\n          linker((clone, scope) => {\n            promises = insertElement(clone, sibling);\n            wrapper.element = clone;\n            wrapper.scope = scope;\n            scope[itemName] = wrapper.item;\n          });\n          // ui-scroll-grid apply\n          if (adapter.transform) {\n            const tdInitializer = wrapper.scope.uiScrollTdInitializer;\n            if (tdInitializer && tdInitializer.linking) {\n              adapter.transform(wrapper.scope, wrapper.element);\n            } else {\n              wrapper.scope.uiScrollTdInitializer = {\n                onLink: () => adapter.transform(wrapper.scope, wrapper.element),\n                scope: wrapper.scope\n              };\n            }\n          }\n          return promises;\n        }\n\n        function updateDOM() {\n          let promises = [];\n          const toBePrepended = [];\n          const toBeRemoved = [];\n          const inserted = [];\n\n          buffer.forEach((wrapper, i) => {\n            switch (wrapper.op) {\n              case 'prepend':\n                toBePrepended.unshift(wrapper);\n                break;\n              case 'append':\n                insertWrapperContent(wrapper, i);\n                wrapper.op = 'none';\n                inserted.push(wrapper);\n                break;\n              case 'insert':\n                promises = promises.concat(createElement(wrapper, i, viewport.insertElementAnimated));\n                wrapper.op = 'none';\n                inserted.push(wrapper);\n                break;\n              case 'remove':\n                toBeRemoved.push(wrapper);\n            }\n          });\n\n          toBeRemoved.forEach((wrapper) => promises = promises.concat(viewport.removeItem(wrapper)));\n\n          if (toBePrepended.length)\n            toBePrepended.forEach((wrapper) => {\n              insertWrapperContent(wrapper);\n              wrapper.op = 'none';\n            });\n\n          buffer.forEach((item, i) => item.scope.$index = buffer.first + i);\n\n          return {\n            prepended: toBePrepended,\n            removed: toBeRemoved,\n            inserted: inserted,\n            animated: promises\n          };\n\n        }\n\n        function updatePaddings(rid, updates) {\n          // schedule another adjustBuffer after animation completion\n          if (updates.animated.length) {\n            $q.all(updates.animated).then(() => {\n              viewport.adjustPaddings();\n              adjustBuffer(rid);\n            });\n          } else {\n            viewport.adjustPaddings();\n          }\n        }\n\n        function enqueueFetch(rid, updates) {\n          if (viewport.shouldLoadBottom()) {\n            if (!updates || buffer.effectiveHeight(updates.inserted) > 0) {\n              // this means that at least one item appended in the last batch has height > 0\n              if (pending.push(true) === 1) {\n                adapter.loading(true);\n                fetch(rid);\n              }\n            }\n          } else if (viewport.shouldLoadTop()) {\n            if ((!updates || buffer.effectiveHeight(updates.prepended) > 0) || pending[0]) {\n              // this means that at least one item appended in the last batch has height > 0\n              // pending[0] = true means that previous fetch was appending. We need to force at least one prepend\n              // BTW there will always be at least 1 element in the pending array because bottom is fetched first\n              if (pending.push(false) === 1) {\n                adapter.loading(true);\n                fetch(rid);\n              }\n            }\n          }\n        }\n\n        function processUpdates() {\n          const updates = updateDOM();\n\n          // We need the item bindings to be processed before we can do adjustments\n          !$scope.$$phase && !$rootScope.$$phase && $scope.$digest();\n\n          updates.inserted.forEach(w => elementRoutines.showElement(w));\n          updates.prepended.forEach(w => elementRoutines.showElement(w));\n          return updates;\n        }\n\n        function adjustBuffer(rid) {\n          if (!rid) { // dismiss pending requests\n            pending = [];\n            rid = ++ridActual;\n          }\n\n          const updates = processUpdates();\n\n          if (isInvalid(rid)) {\n            return;\n          }\n\n          updatePaddings(rid, updates);\n          enqueueFetch(rid);\n\n          if (!pending.length) {\n            adapter.calculateProperties();\n          }\n        }\n\n        function adjustBufferAfterFetch(rid) {\n          const updates = processUpdates();\n\n          viewport.onAfterPrepend(updates);\n\n          if (isInvalid(rid)) {\n            return;\n          }\n\n          updatePaddings(rid, updates);\n          onRenderHandlersRunner();\n          enqueueFetch(rid, updates);\n          pending.shift();\n\n          if (pending.length)\n            fetch(rid);\n          else {\n            adapter.loading(false);\n            bindEvents();\n            adapter.calculateProperties();\n          }\n        }\n\n        function fetch(rid) {\n          if (pending[0]) {// scrolling down\n            if (buffer.length && !viewport.shouldLoadBottom()) {\n              adjustBufferAfterFetch(rid);\n            } else {\n              fetchNext((result) => {\n                if (isInvalid(rid)) {\n                  return;\n                }\n\n                if (result.length < bufferSize) {\n                  buffer.eof = true;\n                }\n\n                if (result.length > 0) {\n                  viewport.clipTop();\n                  buffer.append(result);\n                }\n\n                adjustBufferAfterFetch(rid);\n              });\n            }\n          } else {  // scrolling up\n            if (buffer.length && !viewport.shouldLoadTop()) {\n              adjustBufferAfterFetch(rid);\n            } else {\n              fetchPrevious((result) => {\n                if (isInvalid(rid)) {\n                  return;\n                }\n\n                if (result.length < bufferSize) {\n                  buffer.bof = true;\n                  // log 'bof is reached'\n                }\n\n                if (result.length > 0) {\n                  if (buffer.length) {\n                    viewport.clipBottom();\n                  }\n                  buffer.prepend(result);\n                }\n\n                adjustBufferAfterFetch(rid);\n              });\n            }\n          }\n        }\n\n        function resizeAndScrollHandler() {\n          if (!$rootScope.$$phase && !adapter.isLoading && !adapter.disabled) {\n\n            enqueueFetch(ridActual);\n\n            if (pending.length) {\n              unbindEvents();\n            } else {\n              adapter.calculateProperties();\n              !$scope.$$phase && $scope.$digest();\n            }\n          }\n        }\n\n        function wheelHandler(event) {\n          if (!adapter.disabled) {\n            const scrollTop = viewport[0].scrollTop;\n            const yMax = viewport[0].scrollHeight - viewport[0].clientHeight;\n\n            if ((scrollTop === 0 && !buffer.bof) || (scrollTop === yMax && !buffer.eof)) {\n              event.preventDefault();\n            }\n          }\n        }\n      }\n\n    }\n  ]);\n\n\n// WEBPACK FOOTER //\n// ./src/ui-scroll.js"],"sourceRoot":""}